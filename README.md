# LLM Web Browser

An open-source project that leverages Large Language Models (LLMs) to interact with web pages, enabling multi-step goal-oriented browsing. This project focuses on summarizing complex HTML structures into concise representations suitable for LLM processing while preserving the functionality of the original web page.

## Table of Contents

- [LLM Web Browser](#llm-web-browser)
  - [Table of Contents](#table-of-contents)
  - [Overview](#overview)
  - [Features](#features)
  - [Installation](#installation)
    - [Prerequisites](#prerequisites)
    - [Interacting with the LLM Browser](#interacting-with-the-llm-browser)
  - [Example Output](#example-output)
  - [How It Works](#how-it-works)

---

## Overview

Modern web pages often contain intricate HTML structures and visual elements that can be challenging for language models to interpret. This project provides an intelligent web browsing experience by:

- Simplifying complex HTML into a concise, context-friendly format for LLMs.
- Extracting and summarizing visual information from images and SVG icons using a lightweight vision LLM.
- Allowing the LLM to perform multi-step actions to achieve user-defined goals within the browser.

---

## Features

- **HTML Summarization**: Converts complex HTML DOM trees into simplified representations to reduce context size for LLM processing while maintaining essential functionality.
- **SVG and Image Description**: Utilizes a vision LLM to interpret and summarize the meaning of non-textual elements like icons and images, embedding this information into the LLM context.
- **Goal-Oriented Browsing**: Enables the LLM to perform sequential actions (e.g., clicking buttons, filling forms) to accomplish specific tasks on the web.
- **Virtual DOM Representation**: Provides a text-based, hierarchical representation of the web page's DOM for easier interpretation by both developers and the LLM.
- **OpenAI and Groq API Integration**: Leverages APIs for language processing and vision tasks.

---

## Installation

### Prerequisites

- Node.js (v14 or higher)
- npm or yarn
- [Chrome](https://www.google.com/chrome/) installed on your system
- API keys for [OpenAI](https://openai.com/api/) and [Groq](https://groq.com/) (can be adapted easily for local use like ollama or vllm)

### Interacting with the LLM Browser

- The CLI interface will prompt you for input.
- Enter your goal or command, and the LLM will navigate and interact with web pages to accomplish it.
- You can send followup commands or instructions as needed.
- Avoid clicking inside the controlled browser as it can shift the DOM node ids.

---

## Example Output

An example of the virtual DOM representation generated by the application ([https://roame.travel](https://roame.travel))

```jade
html(489)
  body(491)
    main(576)
      div(577)
        div(589)
          a(590) [href="/", interactable: true]
            svg(595) [description: "A visual representation of something."]
              path(596) [interactable: true]
          div(591)
            a(597) [href="/skyview", interactable: true]
              div(608) [interactable: true]
                div(609) [interactable: true] "SkyView"
                div(612) [interactable: true] "Pro"
            a(598) [href="/discover", interactable: true] "Discover"
            a(600) [href="/guides", interactable: true] "Guides"
            a(602) [href="/credit-cards", interactable: true] "Credit Cards"
            a(604) [href="/wallet", interactable: true] "Wallet"
            a(606) [href="/subscription", interactable: true] "Membership"
          div(592)
            a(614) [href="/signin", interactable: true] "Log In"
            a(616) [href="/signup", interactable: true]
              button(617) [interactable: true] "Sign Up"
          div(619)
            svg(620) [description: "A visual representation of a sound or noise."]
              path(623)
              path(624)
              path(625)
              path(627)
              path(628)
            div(629) "Create an account for access to thousands of flight deals!Already have an account?"
              a(631) [href="/signup", interactable: true] "Sign Up"
              a(634) [href="/signin", interactable: true] "Log In"
            svg(622) [description: "A symbol representing a cross."]
              path(636) [interactable: true]
        div(579)
          div(637) "Free flightsusing points"
          div(638) "Book your dream vacation with points"
          div(640)
            div(649) [interactable: true] "Economy / Premium Economy"
              svg(655) [description: "A downward-pointing triangle."]
                path(656) [interactable: true]
            div(652)
              button(657) [interactable: true, disabled: true]
                svg(660) [description: "A visual representation of an object or concept."]
                  path(661) [interactable: true]
              div(658) "1"
                div(663) "Traveler"
              button(659) [interactable: true]
                svg(665) [description: "A visual representation of a plus sign."]
                  path(666) [interactable: true]
            div(653) [interactable: true] "SkyView"
              button(668) [interactable: true]
                div(669) [interactable: true]
                  svg(670) [description: "A toggle switch."]
                    path(672) [interactable: true]
                  svg(671) [description: "A toggle switch."]
                    path(673) [interactable: true]
          div(674)
            div(675) [interactable: true]
              svg(680) [description: "A visual representation of an object or concept."]
                path(682) [interactable: true]
              div(681) [interactable: true]
                div(683) [interactable: true] "From"
                input(690) [interactable: true, value="Philly", aria-expanded="true", aria-haspopup="listbox", aria-owns="rc_select_1_list", aria-autocomplete="list", aria-controls="rc_select_1_list", aria-activedescendant="rc_select_1_list_-1"]
            button(676) [interactable: true]
              svg(692) [description: "An image with arrows pointing in different directions."]
                ellipse(693) [interactable: true]
                g(694) [interactable: true]
                  path(697) [interactable: true]
                  path(699) [interactable: true]
            div(677) [interactable: true]
              svg(700) [description: "A visual representation of an object or scene."]
                path(702) [interactable: true]
              div(701) [interactable: true]
                div(703) [interactable: true] "To"
                input(710) [interactable: true, value="San Francisco (SFO)", aria-expanded="false", aria-haspopup="listbox", aria-owns="rc_select_2_list", aria-autocomplete="list", aria-controls="rc_select_2_list"]
            div(678) [interactable: true]
              svg(714) [interactable: true, description: "A visual representation of a calendar."]
                path(715) [interactable: true]
              div(713) [interactable: true]
                div(716) [interactable: true] "Departure Date"
                div(722)
                  input(723) [interactable: true, value="Oct 14, 2024", aria-label="Date", aria-describedby="DateInput__screen-reader-message-single-date-picker"]
                  p(725) "Navigate forward to interact with the calendar and select a date. Press the question mark key to get the keyboard shortcuts for changing dates."
            button(679) [interactable: true]
              svg(727) [description: "A magnifying glass."]
                path(728) [interactable: true]
          div(729)
```


---

## How It Works

1. **Browser Launch and DOM Extraction**
   - Utilizes `chrome-launcher` and `chrome-remote-interface` to programmatically launch Chrome and interact with pages.
   - Extracts the DOM using the Chrome DevTools Protocol (CDP) and represents it as a JavaScript object.

2. **DOM Processing and Flattening**
   - Traverses and simplifies the DOM tree to remove unnecessary nesting and reduce context size.
   - Identifies interactable elements and preserves essential attributes like `href`, `value`, and `aria-` properties.

3. **SVG Processing**
   - Converts SVG elements to PNG images using `sharp`.
   - Generates a hash for caching purposes to avoid redundant computations.
   - Sends the PNG images to the Groq API, powered by a lightweight vision LLM, to get textual descriptions of icons and images.

4. **LLM Interaction**
   - Prepares a system prompt including the simplified DOM for OpenAI's GPT.
   - Handles user inputs and assistant responses to perform actions like clicking elements, entering text, and navigating to URLs.
   - Updates the DOM representation after each interaction to reflect changes.

5. **Command Execution**
   - Executes browser commands (click, input, navigate) based on assistant's function calls.
   - Uses CDP to perform actions directly on the page elements identified by their `nodeId`.